<%- contentFor('content') %>
<% include ../partials/messages %>

<div class="row">
    <div class="col-md-12">

        <!-- DATA TABLE -->
        <h3 class="title-5 m-b-35">data table</h3>
        <div class="table-data__tool">
            <div class="table-data__tool-left">
                <div class="rs-select2--light rs-select2--md">
                    <select class="js-select2" name="property">
                        <option selected="selected">All Properties</option>
                        <option value="">Option 1</option>
                        <option value="">Option 2</option>
                    </select>
                    <div class="dropDownSelect2"></div>
                </div>
                <div class="rs-select2--light rs-select2--sm">
                    <select class="js-select2" name="time">
                        <option selected="selected">Today</option>
                        <option value="">3 Days</option>
                        <option value="">1 Week</option>
                    </select>
                    <div class="dropDownSelect2"></div>
                </div>
                <button class="au-btn-filter">
                    <i class="zmdi zmdi-filter-list"></i>filters</button>
            </div>

            <div class="table-data__tool-right">
                <a id="exportCSV" class="au-btn au-btn-icon au-btn--green au-btn--small">
                    <i class="zmdi zmdi-plus"></i>export</a>

            </div>

            <div class="table-data__tool-right">
                <a href="/products/add-product" class="au-btn au-btn-icon au-btn--green au-btn--small">
                    <i class="zmdi zmdi-plus"></i>add product</a>

            </div>
        </div>
        <div class="table-responsive table-responsive-data2">
            <table class="table table-data2" id="productsTable">
                <thead>
                    <tr>
                        <th>Sr No</th>

                        <th>Posted date</th>
                        <th>Product Name/ASIN</th>
                        <th>Product Description</th>
                        <th>Unit(s)</th>
                        <th>Shipping Charges</th>
                        <th>Available Quantity</th>
                        <th>Unit Price</th>
                        <th>FBA Fee</th>
                        <th>Referral Fee</th>
                        <th>Sample Fee</th>
                        <th>Setup Fee</th>
                        <th>Inspection Fee</th>
                        <th>Misc Fee</th>
                        <th>Product Cost</th>
                        <th>Fee Total</th>
                        <th>Order & Staging cost</th>
                        <th>Shipping Total</th>
                        <th>Landed Order</th>
                        <th>Landed Average Cost</th>
                        <th>Fulfilled Unit Cost</th>
                        <th>Amazon Fee Per Order</th>


                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <% productsData.forEach((products) => { %>
                    <tr class="tr-shadow">
                        <td></td>

                        <td>
                            <%= products.PostedDate %>
                        </td>

                        <td>
                              
                            <a href = "/products/ShowProfit/<%= products._id %>" >
                            <%= products.ProductName %></a>
                        </td>

                        <td>
                            <%= products.ProductDesc %>
                        </td>

                        <td>
                            <%= products.Units %>
                        </td>

                        <td>
                            <%= products.ShippingChargeCurrency %> <%= products.ShippingCharge %>
                        </td>

                        <% if (products.AvailableQuantity == null) { %>

                        <td> N/A </td>

                        <% } else { %>

                        <td>
                            <%= products.AvailableQuantity %>
                        </td>

                        <% } %>

                        <% if (products.Principal == null) { %>

                        <td>
                            N/A
                        </td>

                        <% } else { %>

                        <td>
                            <%= products.PrincipalCurrency %> <%= products.Principal %>
                        </td>

                        <% } %>

                        <td>
                            <%= products.FBACurrency %> <%= products.FBA %>
                        </td>

                        <td>
                            <%= products.ReferralFeeCurrency %> <%= products.ReferralFee %>
                        </td>

                        <td>
                            <%= products.sampleFeeCurrency %> <%= products.sampleFee %>
                        </td>

                        <td>
                            <%= products.setupFeeCurrency %> <%= products.setupFee %>
                        </td>

                        <td>
                            <%= products.inspectionFeeCurrency %> <%= products.inspectionFee %>
                        </td>

                        <td>
                            <%= products.miscFeeCurrency %> <%= products.miscFee %>
                        </td>

                        <td>
                            <%= products.productCostCurrency %> <%= products.productCost %>
                        </td>

                        <td>
                            <%= products.feeTotalCurrency %> <%= products.feeTotal %>
                        </td>

                        <td>
                            <%= products.orderAndStagingFeeCurrency %> <%= products.orderAndStagingFee %>
                        </td>

                        <td>
                            <%= products.shippingTotalCurrency %> <%= products.shippingTotal %>
                        </td>

                        <td>
                            <%= products.landedOrderCurrency %> <%= products.landedOrder %>
                        </td>

                        <td>
                            <%= products.landedAvgCostCurrency %> <%= products.landedAvgCost %>
                        </td>

                        <td>
                            <%= products.fulfilledUnitCostCurrency %> <%= products.fulfilledUnitCost %>
                        </td>

                        <td>
                            <%= products.amznFeePerOrderCurrency %> <%= products.amznFeePerOrder %>
                        </td>

                        <td>
                            <div class="table-data-feature">

                                <a class="item" href="/products/edit-product/<%= products._id %>" data-toggle="tooltip"
                                    data-placement="top" title="Edit">
                                    <i class="zmdi zmdi-edit"></i>
                                </a>

                                <a class="item" data-toggle="tooltip" href="/products/delete-product/<%= products._id %>"
                                    data-placement="top" title="Delete" data-toggle="modal" id="#deleteButton"
                                    onclick="return confirm('Are you sure?')">
                                    <i class="zmdi zmdi-delete"></i>
                                </a>

                            </div>
                        </td>
                    </tr>
                    <% }) %>

                </tbody>
            </table>
        </div>
        <!-- END DATA TABLE -->
    </div>
</div>

<!-- modal static -->
<div class="modal fade" id="staticModal" tabindex="-1" role="dialog" aria-labelledby="staticModalLabel"
    aria-hidden="true" data-backdrop="static">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticModalLabel">Static Modal</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>
                    This is a static modal, backdrop click will not close it.
                </p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary">Confirm</button>
            </div>
        </div>
    </div>
</div>
<!-- end modal static -->


<script>
    $(document).ready(function () {
        $('.alert-danger, .alert-success').css('top' , '24px');
        setTimeout(function(){
            $('.alert-danger, .alert-success').hide();}, 3000); 

        var t = $('#productsTable').DataTable({
            "columnDefs": [{
                "searchable": false,
                "orderable": false,
                "targets": 0
            }],
            "order": [
                [1, 'asc']
            ],
            dom: 'Bfrtip',
            buttons: [
                'copyHtml5',
                'excelHtml5',
                'csvHtml5',
                'pdfHtml5'
            ]
        });

        t.on('order.dt search.dt', function () {
            t.column(0, {
                search: 'applied',
                order: 'applied'
            }).nodes().each(function (cell, i) {
                cell.innerHTML = i + 1;
            });
        }).draw();
    });

    document.getElementById('exportCSV').onclick = function () {
        $(".buttons-csv").click();
    };
</script>

<style>
    .dt-buttons {
        display: none !important;
    }
</style>